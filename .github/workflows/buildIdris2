name: 'Build Idris2'
on:
  push:
    branches: ['main']
jobs:
  buildIdris2:
    name: Deploy staging
    runs-on: ubuntu-latest
    steps:
      - name: Install dependencies
        run: sudo apt-get -y install build-essential clang chezscheme
      - name: Checkout idris2 repository
        uses: actions/checkout@v3
        with:
          repository: idris-lang/Idris2
          path: idris2-source
          ref: v0.5.1
      - name: Build idris2
       run: |
          cd idris2-source
          export SCHEME=scheme
          export PATH="${PATH}:~/.idris2/bin"
          make bootstrap
          make install
      - name: Test 
        run: ~/.idris2/bin/idris2 -v
        
